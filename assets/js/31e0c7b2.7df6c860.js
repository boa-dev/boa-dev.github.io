"use strict";(self.webpackChunkboajs_dev=self.webpackChunkboajs_dev||[]).push([[8534],{9997:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>h});var a=s(4848),n=s(8453);const r={layout:"post",tags:["post"],title:"Boa release v0.13",author:"Boa Developers",permalink:"2021/09/30/boa-release-13.html"},o=void 0,i={permalink:"/blog/2021/09/30/boa-release-13",source:"@site/blog/2021-09-30-boa-release-13.md",title:"Boa release v0.13",description:"Boa v0.13 is here! Boa is a JavaScript engine written in the Rust programming language. It makes it easy to embed a JS engine in your projects, and you can even use it from webassembly. See the about page for more info.",date:"2021-09-30T00:00:00.000Z",formattedDate:"September 30, 2021",tags:[{label:"post",permalink:"/blog/tags/post"}],readingTime:4.13,hasTruncateMarker:!1,authors:[{name:"Boa Developers"}],frontMatter:{layout:"post",tags:["post"],title:"Boa release v0.13",author:"Boa Developers",permalink:"2021/09/30/boa-release-13.html"},unlisted:!1,prevItem:{title:"Boa release v0.14",permalink:"/blog/2022/03/15/boa-release-14"},nextItem:{title:"Boa release v0.12",permalink:"/blog/2021/06/07/boa-release-12"}},l={authorsImageUrls:[void 0]},h=[{value:"ECMAScript language features",id:"ecmascript-language-features",level:2},{value:"Boa API",id:"boa-api",level:2},{value:"Calling Rust closures from JavaScript",id:"calling-rust-closures-from-javascript",level:3},{value:"Boa prelude",id:"boa-prelude",level:3},{value:"Test 262",id:"test-262",level:2},{value:"Keeping up with Rust",id:"keeping-up-with-rust",level:2},{value:"Keeping things in order",id:"keeping-things-in-order",level:2},{value:"VM",id:"vm",level:2},{value:"Opening up the discussion",id:"opening-up-the-discussion",level:2},{value:"Thank You",id:"thank-you",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:["Boa v0.13 is here! Boa is a JavaScript engine written in the Rust programming language. It makes it easy to embed a JS engine in your projects, and you can even use it from webassembly. See the ",(0,a.jsx)(t.a,{href:"/about",children:"about"})," page for more info."]}),"\n",(0,a.jsxs)(t.p,{children:["We currently support part of the language. In this release, our conformance has grown to 41.97% of the official ECMAScript Test Suite (Test262). We have closed 40 issues and merged 105 pull requests. You can check the full list of changes ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/blob/v0.13/CHANGELOG.md",children:"here"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"This release brings some new features, such as support for calling Rust closures from JavaScript to improve better interopability between JS and Rust."}),"\n",(0,a.jsx)(t.h2,{id:"ecmascript-language-features",children:"ECMAScript language features"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Groups_and_Ranges",children:"named capture groups"})," are now implemented and enabled."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:'const RE_DATE = /(?<year>[0-9]{4})-(?<month>[0-9]{2})-(?<day>[0-9]{2})/;\n\nconst matchObj = RE_DATE.exec("1999-12-31");\nconst year = matchObj.groups.year; // 1999\nconst month = matchObj.groups.month; // 12\nconst day = matchObj.groups.day; // 31\n'})}),"\n",(0,a.jsxs)(t.p,{children:["This release brings support for the relative indexing method ",(0,a.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/at",children:"String.prototype.at()"}),". This makes it easier to fetch values at the end of an array or string instead of doing ",(0,a.jsx)(t.code,{children:"str[str.length - 1]"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:'const sentence = "The quick brown fox jumps over the lazy dog.";\nlet index = 5;\nconsole.log(\n  `Using an index of ${index} the character returned is ${sentence.at(index)}`,\n);\n// expected output: "Using an index of 5 the character returned is u"\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Other implemented language features include destructoring assignments, ",(0,a.jsx)(t.code,{children:"replaceAll()"}),", ",(0,a.jsx)(t.code,{children:"Object.values()"}),", ",(0,a.jsx)(t.code,{children:"Object.keys()"}),", ",(0,a.jsx)(t.code,{children:"Object.preventExtensions()"}),", ",(0,a.jsx)(t.code,{children:"splice()"}),", ",(0,a.jsx)(t.code,{children:"sort()"}),", spreading objects and more."]}),"\n",(0,a.jsx)(t.h2,{id:"boa-api",children:"Boa API"}),"\n",(0,a.jsx)(t.h3,{id:"calling-rust-closures-from-javascript",children:"Calling Rust closures from JavaScript"}),"\n",(0,a.jsxs)(t.p,{children:["In addition to registering Rust functions as global JavaScript functions, our API has been expanded to register Rust closures. ",(0,a.jsx)(t.a,{href:"https://docs.rs/Boa/0.13.0/boa/context/struct.Context.html#method.register_global_closure",children:(0,a.jsx)(t.code,{children:"register_global_closure"})})," allows to capture variables in closures that can be called from javascript:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-rust",children:'let mut context = Context::new();\nlet add_value = 1.0;\ncontext.register_global_closure("addOne", 1, move |_, args, _| {\n    let argument = args.get(0).unwrap().as_number().unwrap();\n    Ok(JsValue::new(argument + add_value))\n})?;\nassert_eq!(context.eval("addOne(41)")?, 42.into());\n'})}),"\n",(0,a.jsxs)(t.p,{children:["To see the full capabilities of this feature, take a look at our ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/blob/main/boa/examples/closures.rs",children:"examples"}),". Thanks to @HalidOdat and @jedel1043 for their work on this."]}),"\n",(0,a.jsx)(t.h3,{id:"boa-prelude",children:"Boa prelude"}),"\n",(0,a.jsx)(t.p,{children:"This release exposes a prelude of useful things that are already imported. This should make it more ergonomic to work with."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-rust",children:'use boa::prelude::*; // This would import all the commonly-used things\n\nfn main() {\n\tlet number = JSValue::number(3.1415);\n\tlet realm = Realm::create();\n\tlet mut engine = Interpreter::new(realm);\n\tlet result = forward(&mut engine, "Math.PI");\n}\n'})}),"\n",(0,a.jsx)(t.h2,{id:"test-262",children:"Test 262"}),"\n",(0,a.jsx)(t.p,{children:"Test262 is the implementation conformance test suite maintained by TC39. It's used by nearly all engines to measure how conformant they are to the specification. Boa pulls the tests in-tree and runs them against all PRs."}),"\n",(0,a.jsx)(t.p,{children:"Since v0.12 we have managed to pass 6391 more tests and are 7% more conformant. This has been great progress by all involved and we hope this continues to improve. Most of these new passes have come from refactors across the codebase which have had little impact on performance, in fact, v0.13 is much faster than v0.12."}),"\n",(0,a.jsxs)(t.p,{children:["You can track Boa's conformance to the specification ",(0,a.jsx)(t.a,{href:"https://boa-dev.github.io/boa/test262/#",children:"here"})]}),"\n",(0,a.jsx)(t.h2,{id:"keeping-up-with-rust",children:"Keeping up with Rust"}),"\n",(0,a.jsxs)(t.p,{children:["Rust is changing underneath us. This means we need to make sure our code is conforming the latest standards and we're taking advantage of the best optimizations the language can provide. In order to do this we rely on Clippy, this is Rust's in-house linter. We updated our code to ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/pull/1352",children:"respect the latest Rust version"})," and updated ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/pull/1356",children:"formatting"}),'. Often a nice bonus of doing this is getting performance improvements for free as Clippy gets more "smarter". Thanks to @neeldug and @RageKnify for the work in this area.']}),"\n",(0,a.jsx)(t.h2,{id:"keeping-things-in-order",children:"Keeping things in order"}),"\n",(0,a.jsxs)(t.p,{children:["Previously object properties were stored using ",(0,a.jsx)(t.a,{href:"https://docs.rs/rustc-hash/1.1.0/rustc_hash/type.FxHashMap.html",children:(0,a.jsx)(t.code,{children:"FxHashMap"})}),". Despite being very fast it didn't offer any guarantees about the order. Properties need to retain the same order they were entered. In order to achieve this we switched over to ",(0,a.jsx)(t.a,{href:"https://docs.rs/indexmap/1.7.0/indexmap/",children:"IndexMap"}),". Traits in Rust make this easy as IndexMap was designed to be a drop-in replacement for other HashMap implementations by following the same Trait. Thanks to IndexMap offering the possibility to use alternative hashing algorithms, we could continue using the fast ",(0,a.jsx)(t.a,{href:"https://docs.rs/rustc-hash/1.1.0/rustc_hash/struct.FxHasher.html",children:(0,a.jsx)(t.code,{children:"FxHasher"})})," algorithm from rustc. Performance losses were minimal on some benchmarks and we actually made some gains in others. Thanks to @raskad for their work on this"]}),"\n",(0,a.jsx)(t.h2,{id:"vm",children:"VM"}),"\n",(0,a.jsxs)(t.p,{children:["There is still on-going work to utilise a VM, this is happening ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/blob/main/docs/vm.md#state-of-play",children:"alongside"})," how Boa runs today. Although its not exposed yet there has been plenty of refactorings to the VM in order to make it performant. Hopefully we can talk about this in more detail soon."]}),"\n",(0,a.jsx)(t.h2,{id:"opening-up-the-discussion",children:"Opening up the discussion"}),"\n",(0,a.jsxs)(t.p,{children:["As of this release Boa has begun to utilise Github's Discussions feature. You can catch more long-ranging projects ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/discussions",children:"here"})]}),"\n",(0,a.jsx)(t.h2,{id:"thank-you",children:"Thank You"}),"\n",(0,a.jsxs)(t.p,{children:["This has been the biggest release yet, there have been many features and fixes. We want to thank all the ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/graphs/contributors?from=2021-06-01&to=2021-09-26&type=c",children:"contributors"})," in this release, whether it was features, fixes or raising bugs."]}),"\n",(0,a.jsxs)(t.p,{children:["If you're interested in contributing to Boa, we have some ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/issues?q=is%3Aopen+is%3Aissue+label%3A%22good+first+issue%22",children:'"good first issues"'})," and ",(0,a.jsx)(t.a,{href:"https://github.com/boa-dev/boa/issues?q=is%3Aopen+is%3Aissue+label%3A%22help+wanted%22",children:'"issues where help is wanted"'}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>i});var a=s(6540);const n={},r=a.createContext(n);function o(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),a.createElement(r.Provider,{value:t},e.children)}}}]);