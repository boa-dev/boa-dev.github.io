<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Boa release v0.13 - Boa</title>
    <meta name="description" content="The blog and website for Boa">
    <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml" />
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/center-img.css">
    <link rel="stylesheet" href="/css/prism.css">
    <link rel="canonical" href="https://boa-dev.github.io/2021/09/30/boa-release-13.html">
    <link rel="shortcut icon" href="/favicon-32x32.png">
    <meta property="og:image" content="/images/logo.png" />
    <meta property="og:description" content="The blog and website for Boa" />
    <meta property="og:title" content="" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel="stylesheet">

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@boa_engine" />
    <meta name="twitter:title" content="" />
    
    <meta name="twitter:description" content="The blog and website for Boa" />
    
    <meta name="twitter:url" content="/2021/09/30/boa-release-13.html">
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({ startOnLoad: true });</script>
    <noscript>
        <style>
            .site-switch-theme {display:none;}
        </style>
    </noscript>
</head>


  <body>

    <header class="site-header">
  <script type="text/javascript">
    // By calling this on DOM Ready rather than window.load means we should have our
    // preferred color and classes set before the user sees the page (no flash)
    document.addEventListener("DOMContentLoaded", () => {
      detectColorScheme();
    });

    function applyTheme() {
      const checkbox = window.document.getElementById("toggleTheme");
      window.document.getElementsByTagName(
        "html"
      )[0].className = window.document.getElementById("toggleTheme").checked
        ? "dark"
        : "default";
      localStorage.setItem(
        "theme",
        window.document.getElementsByTagName("html")[0].className
      );
    }

    //determines if the user has a set theme
    function detectColorScheme() {
      let theme = "default"; //default to light

      //local storage is used to override OS theme settings
      if (localStorage.getItem("theme")) {
        theme = localStorage.getItem("theme");
      } else if (!window.matchMedia) {
        //matchMedia method not supported
        return false;
      } else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
        //OS theme setting detected as dark
        theme = "dark";
      }

      //dark theme preferred, set document with a `data-theme` attribute
      window.document.getElementsByTagName("html")[0].className = theme;
      localStorage.setItem("theme", theme);
      if (theme === "dark") {
        window.document.getElementById("toggleTheme").checked = true;
      }
    }
  </script>
  <div class="wrapper">
    <a class="site-title" href="/"
      ><img id="site-logo" src="/images/logo.png" /> Boa</a
    >

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path
            fill="#424242"
            d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"
          />
          <path
            fill="#424242"
            d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"
          />
          <path
            fill="#424242"
            d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"
          />
        </svg>
      </a>

      <div class="trigger">
        <a href="/about">About</a> |
        <a href="https://github.com/boa-dev/boa">Github</a> |
        <a href="https://boa-dev.github.io/boa/dev/bench/">Benchmarks</a> |
        <a href="https://boa-dev.github.io/boa/test262/">Conformance</a> |
        <a href="https://boa-dev.github.io/boa/playground">Playground</a> |
        <a href="https://boa-dev.github.io/boa/doc">Docs</a>
      </div>
    </nav>
    <!-- <label class="site-switch-theme">
      <input type="checkbox" id="toggleTheme" onclick="applyTheme()">
      <span class="slider"></span>
    </label> -->
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Boa release v0.13</h1>
    <p class="post-meta">Sep 30, 2021 â€¢ Boa Developers</p>
  </header>

  <article class="post-content">
    <p>Boa v0.13 is here! Boa is a JavaScript engine written in the Rust programming language. It makes it easy to embed a JS engine in your projects, and you can even use it from webassembly. See the <a href="/about">about</a> page for more info.</p>
<p>We currently support part of the language. In this release, our conformance has grown to 41.97% of the official ECMAScript Test Suite (Test262). We have closed 40 issues and merged 105 pull requests. You can check the full list of changes <a href="https://github.com/boa-dev/boa/blob/v0.13/CHANGELOG.md">here</a>.</p>
<p>This release brings some new features, such as support for calling Rust closures from JavaScript to improve better interopability between JS and Rust.</p>
<h2>ECMAScript language features</h2>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Groups_and_Ranges">named capture groups</a> are now implemented and enabled.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token constant">RE_DATE</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;year>[0-9]{4})-(?&lt;month>[0-9]{2})-(?&lt;day>[0-9]{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> matchObj <span class="token operator">=</span> <span class="token constant">RE_DATE</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"1999-12-31"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> year <span class="token operator">=</span> matchObj<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>year<span class="token punctuation">;</span> <span class="token comment">// 1999</span><br><span class="token keyword">const</span> month <span class="token operator">=</span> matchObj<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>month<span class="token punctuation">;</span> <span class="token comment">// 12</span><br><span class="token keyword">const</span> day <span class="token operator">=</span> matchObj<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>day<span class="token punctuation">;</span> <span class="token comment">// 31</span></code></pre>
<p>This release brings support for the relative indexing method <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/at">String.prototype.at()</a>. This makes it easier to fetch values at the end of an array or string instead of doing <code>str[str.length - 1]</code>.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> sentence <span class="token operator">=</span> <span class="token string">"The quick brown fox jumps over the lazy dog."</span><span class="token punctuation">;</span><br><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Using an index of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> the character returned is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sentence<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><br><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">// expected output: "Using an index of 5 the character returned is u"</span></code></pre>
<p>Other implemented language features include destructoring assignments, <code>replaceAll()</code>, <code>Object.values()</code>, <code>Object.keys()</code>, <code>Object.preventExtensions()</code>, <code>splice()</code>, <code>sort()</code>, spreading objects and more.</p>
<h2>Boa API</h2>
<h3>Calling Rust closures from JavaScript</h3>
<p>In addition to registering Rust functions as global JavaScript functions, our API has been expanded to register Rust closures. <a href="https://docs.rs/Boa/0.13.0/boa/context/struct.Context.html#method.register_global_closure"><code>register_global_closure</code></a> allows to capture variables in closures that can be called from javascript:</p>
<pre class="language-rust"><code class="language-rust"><span class="token keyword">let</span> <span class="token keyword">mut</span> context <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">let</span> add_value <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span><br>context<span class="token punctuation">.</span><span class="token function">register_global_closure</span><span class="token punctuation">(</span><span class="token string">"addOne"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>_<span class="token punctuation">,</span> args<span class="token punctuation">,</span> _<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> argument <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">JsValue</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>argument <span class="token operator">+</span> add_value<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span><br><span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"addOne(41)"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>To see the full capabilities of this feature, take a look at our <a href="https://github.com/boa-dev/boa/blob/main/boa/examples/closures.rs">examples</a>. Thanks to @HalidOdat and @jedel1043 for their work on this.</p>
<h3>Boa prelude</h3>
<p>This release exposes a prelude of useful things that are already imported. This should make it more ergonomic to work with.</p>
<pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">boa<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span> <span class="token comment">// This would import all the commonly-used things</span><br><br><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token class-name">JSValue</span><span class="token punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token number">3.1415</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">let</span> realm <span class="token operator">=</span> <span class="token class-name">Realm</span><span class="token punctuation">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">let</span> <span class="token keyword">mut</span> engine <span class="token operator">=</span> <span class="token class-name">Interpreter</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>realm<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">forward</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> engine<span class="token punctuation">,</span> <span class="token string">"Math.PI"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<h2>Test 262</h2>
<p>Test262 is the implementation conformance test suite maintained by TC39. It's used by nearly all engines to measure how conformant they are to the specification. Boa pulls the tests in-tree and runs them against all PRs.</p>
<p>Since v0.12 we have managed to pass 6391 more tests and are 7% more conformant. This has been great progress by all involved and we hope this continues to improve. Most of these new passes have come from refactors across the codebase which have had little impact on performance, in fact, v0.13 is much faster than v0.12.</p>
<p>You can track Boa's conformance to the specification <a href="https://boa-dev.github.io/boa/test262/#">here</a></p>
<h2>Keeping up with Rust</h2>
<p>Rust is changing underneath us. This means we need to make sure our code is conforming the latest standards and we're taking advantage of the best optimizations the language can provide. In order to do this we rely on Clippy, this is Rust's in-house linter. We updated our code to <a href="https://github.com/boa-dev/boa/pull/1352">respect the latest Rust version</a> and updated <a href="https://github.com/boa-dev/boa/pull/1356">formatting</a>. Often a nice bonus of doing this is getting performance improvements for free as Clippy gets more &quot;smarter&quot;. Thanks to @neeldug and @RageKnify for the work in this area.</p>
<h2>Keeping things in order</h2>
<p>Previously object properties were stored using <a href="https://docs.rs/rustc-hash/1.1.0/rustc_hash/type.FxHashMap.html"><code>FxHashMap</code></a>. Despite being very fast it didn't offer any guarantees about the order. Properties need to retain the same order they were entered. In order to achieve this we switched over to <a href="https://docs.rs/indexmap/1.7.0/indexmap/">IndexMap</a>. Traits in Rust make this easy as IndexMap was designed to be a drop-in replacement for other HashMap implementations by following the same Trait. Thanks to IndexMap offering the possibility to use alternative hashing algorithms, we could continue using the fast <a href="https://docs.rs/rustc-hash/1.1.0/rustc_hash/struct.FxHasher.html"><code>FxHasher</code></a> algorithm from rustc. Performance losses were minimal on some benchmarks and we actually made some gains in others. Thanks to @raskad for their work on this</p>
<h2>VM</h2>
<p>There is still on-going work to utilise a VM, this is happening <a href="https://github.com/boa-dev/boa/blob/main/docs/vm.md#state-of-play">alongside</a> how Boa runs today. Although its not exposed yet there has been plenty of refactorings to the VM in order to make it performant. Hopefully we can talk about this in more detail soon.</p>
<h2>Opening up the discussion</h2>
<p>As of this release Boa has begun to utilise Github's Discussions feature. You can catch more long-ranging projects <a href="https://github.com/boa-dev/boa/discussions">here</a></p>
<h2>Thank You</h2>
<p>This has been the biggest release yet, there have been many features and fixes. We want to thank all the <a href="https://github.com/boa-dev/boa/graphs/contributors?from=2021-06-01&amp;to=2021-09-26&amp;type=c">contributors</a> in this release, whether it was features, fixes or raising bugs.</p>
<p>If you're interested in contributing to Boa, we have some <a href="https://github.com/boa-dev/boa/issues?q=is%3Aopen+is%3Aissue+label%3A%22good+first+issue%22">&quot;good first issues&quot;</a> and <a href="https://github.com/boa-dev/boa/issues?q=is%3Aopen+is%3Aissue+label%3A%22help+wanted%22">&quot;issues where help is wanted&quot;</a>.</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/boa-dev">
              <span class="icon icon--github">
                <svg viewBox="0 0 16 16">
                  <path
                    fill="#828282"
                    d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"
                  />
                </svg>
              </span>

              <span class="username">boa-dev</span>
            </a>
          </li>
           
          <li>
            <a href="https://twitter.com/boa_engine">
              <span class="icon icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path
                    fill="#828282"
                    d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"
                  />
                </svg>
              </span>

              <span class="username">boa_engine</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <p class="text">The blog and website for Boa</p>
      </div>

      <div class="footer-col footer-col-1">
        <div class="toggle-mode">
          <div class="icon">
            <i class="font font-sun-o" aria-hidden="true"></i>
          </div>
          <div class="toggle-switch">
            <label class="switch" title="Toggle Light/Dark Mode">
              <input
                type="checkbox"
                role="switch"
                id="toggleTheme"
                onclick="applyTheme()"
              />
              <div class="slider round"></div>
            </label>
          </div>
          <div class="icon">
            <i class="font font-moon-o" aria-hidden="true"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>


  </body>

</html>
